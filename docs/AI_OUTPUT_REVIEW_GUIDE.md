# AI生成物のレビュー・修正ガイドライン

このドキュメントは、AIによって生成された成果物（コード、設計書、ドキュメント、テストケース等）を効果的にレビューし、必要に応じて修正・改善するためのガイドラインを提供します。

## 1. 基本原則

-   **人間の最終責任:** AIは強力な支援ツールですが、最終的な成果物の品質と正確性に対する責任は人間（開発者、レビュアー）が負います。
-   **コンテキスト理解の重要性:** AI生成物をレビューする際は、その成果物がどのような指示（プロンプト）と文脈（プロジェクトの背景、既存コード、関連ドキュメント）に基づいて生成されたかを理解することが不可欠です。
-   **批判的思考の維持:** AIの出力を鵜呑みにせず、常に批判的な視点で検証してください。AIは誤りを犯す可能性があり、また最適でない解決策を提示することもあります。
-   **学習と改善の機会:** レビュープロセスは、AIの能力を理解し、より効果的なプロンプトエンジニアリングを学ぶ機会でもあります。

## 2. レビュー観点

AI生成物の種類に応じて、以下の観点を中心にレビューを実施します。

### 2.1. コード (全般)

-   **機能充足性:**
    -   [ ] プロンプトで指示された要件や仕様を完全に満たしているか？
    -   [ ] 期待される入力に対して正しい出力を生成するか？エッジケースは考慮されているか？
-   **論理的整合性と正確性:**
    -   [ ] アルゴリズムやロジックに誤りはないか？
    -   [ ] 複雑な条件分岐やループ処理は正しく記述されているか？
-   **コーディング標準準拠:**
    -   [ ] プロジェクトのコーディング規約 (`CODING_STANDARDS.md`参照) に準拠しているか？ (命名規則、インデント、コメントスタイル等)
    -   [ ] 言語ごとのベストプラクティスに従っているか？
-   **保守性と可読性:**
    -   [ ] コードは理解しやすいか？変数名や関数名は適切か？
    -   [ ] 複雑な部分は適切にコメントされているか？ (必要であればAIにコメント生成を依頼)
    -   [ ] モジュール化や関数の分割は適切か？再利用性は考慮されているか？
-   **パフォーマンス:**
    -   [ ] 非効率な処理やボトルネックとなり得る箇所はないか？
    -   [ ] 大量データ処理や高負荷時を考慮した設計になっているか？
-   **セキュリティ:**
    -   [ ] 潜在的な脆弱性（SQLインジェクション、XSS、バッファオーバーフロー等）は存在しないか？
    -   [ ] 入力値の検証は適切に行われているか？
    -   [ ] 認証・認可処理に問題はないか？
    -   [ ] 機密情報の取り扱いは適切か？
-   **エラーハンドリング:**
    -   [ ] 予期せぬエラーや例外が発生した場合の処理は適切か？
    -   [ ] ユーザーへのエラー通知やログ出力は十分か？
-   **テスト容易性:**
    -   [ ] 単体テストが記述しやすい設計になっているか？依存関係は適切に分離されているか？
-   **既存コードとの互換性:**
    -   [ ] 既存のシステムやライブラリとの連携部分に問題はないか？

### 2.2. ドキュメント (設計書、仕様書、README等)

-   **明確性と理解容易性:**
    -   [ ] 内容は明確かつ簡潔に記述されているか？専門知識のない関係者にも理解できるか？
    -   [ ] 専門用語や略語には適切な説明があるか？
-   **網羅性と正確性:**
    -   [ ] 対象範囲の情報を過不足なく網羅しているか？
    -   [ ] 記述されている情報に誤りや古い情報はないか？最新の状態を反映しているか？
-   **一貫性:**
    -   [ ] ドキュメント内で用語や表現が一貫しているか？
    -   [ ] 関連ドキュメント (`PROJECT_CONTEXT.md`, `ARCHITECTURE.md`等) との内容に矛盾はないか？
-   **構造と可読性:**
    -   [ ] 見出し、箇条書き、図表などが効果的に使われ、構造が分かりやすいか？
    -   [ ] フォーマットはプロジェクト標準に従っているか？
-   **目的適合性:**
    -   [ ] ドキュメントが本来の目的（情報伝達、意思決定支援等）を果たせる内容になっているか？

### 2.3. テストケース

-   **要件カバレッジ:**
    -   [ ] 機能要件やユーザーストーリーを網羅的にカバーしているか？
    -   [ ] 正常系、準正常系、異常系のテストケースがバランス良く含まれているか？
-   **境界値分析とエッジケース:**
    -   [ ] 重要な境界値やエッジケースが考慮されているか？
-   **具体性と再現性:**
    -   [ ] テストの手順、期待される結果が具体的に記述されており、誰でも再現可能か？
-   **独立性と効率性:**
    -   [ ] 各テストケースは可能な限り独立しているか？
    -   [ ]冗長なテストや不必要なテストは含まれていないか？

## 3. 修正・改善プロセス

レビューの結果、修正や改善が必要な場合は以下のプロセスを検討します。

### 3.1. 人間による直接修正

-   **軽微な修正:** 誤字脱字、軽微なロジック修正、コメント追加など、レビュアーが迅速かつ確実に修正できる場合は直接修正します。
-   **AIの限界:** AIが理解しにくい高度なドメイン知識や、プロジェクト固有の複雑な背景に基づく修正は、人間が主導して行う必要があります。

### 3.2. AIへの修正再依頼（プロンプトによる指示）

AIに修正を依頼することで、さらなる学習と効率化が期待できます。

-   **明確な指示:** 修正してほしい箇所、問題点、期待する修正内容を具体的にプロンプトで指示します。
-   **コンテキストの再提供:** 必要に応じて、関連するコードスニペット、エラーメッセージ、参照すべきドキュメントの一部などを再度AIに提供します。
-   **段階的な修正:** 一度に多くの修正を指示するのではなく、問題を分割して段階的に修正を依頼する方が効果的な場合があります。

#### プロンプト例:

**コード修正依頼:**

```text
以下のPython関数には、[具体的な問題点、例: SQLインジェクションの脆弱性] があります。
この問題を修正し、セキュリティを向上させたコードを提案してください。
また、修正点について簡単な解説を加えてください。

```python
# [問題のあるコードスニペットをここに貼り付け]
```
```

```text
このJavaScriptのコードは、[特定の条件下でパフォーマンスが低下する問題] があります。
より効率的なアルゴリズムや記述方法を提案してください。

```javascript
# [問題のあるコードスニペットをここに貼り付け]
```
```

**ドキュメント修正依頼:**

```text
この設計ドキュメントの「システム概要」セクションは、専門知識のないビジネス担当者にも理解できるように、より平易な言葉で書き換えてください。
現在のセクションの主要なポイントは維持しつつ、専門用語は避けるか、簡単な説明を加えてください。

現在の「システム概要」セクション:
「[現在のシステム概要のテキストをここに貼り付け]」
```

```text
このAPI仕様書のレスポンス例が不足しています。
以下のAPIエンドポイントについて、成功時 (HTTP 200) と代表的なエラー時 (HTTP 400, 404, 500) のレスポンスボディのJSON例を追加してください。

APIエンドポイント: `GET /api/v1/users/{id}`
現在の仕様:
「[現在のAPI仕様の一部をここに貼り付け]」
```

**テストケース改善依頼:**

```text
このログイン機能のテストケースには、[問題点、例: パスワード入力に関する異常系のテストが不足している] 点があります。
以下の観点を考慮した異常系のテストケースを追加で3つ提案してください。
- パスワードフィールドが空の場合
- パスワードが短すぎる場合
- パスワードが長すぎる場合
- 許可されていない文字種が含まれる場合

既存のテストケース:
「[既存のテストケースの一部をここに貼り付け]」
```

### 3.3. フィードバックループ

-   AIへの修正依頼後、得られた結果を再度レビューします。
-   期待通りでない場合は、プロンプトを改善して再度依頼するか、人間による直接修正に切り替えます。
-   成功したプロンプトや改善パターンはチームで共有し、今後のAI活用に活かします (`docs/AI_INTERACTION_LOG.md` や `templates/ai-prompts.md` に反映)。

## 4. 注意事項

-   **機密情報の取り扱い:** AIにコードやデータを入力する際は、プロジェクトのセキュリティポリシーに従い、機密情報や個人情報を含めないように注意してください。外部のAIサービスを利用する場合は特に重要です。
-   **著作権とライセンス:** AIが生成したコードやコンテンツが、既存の著作物や特定のライセンスに抵触しないか注意が必要です。特に、学習データに由来するコード片が含まれる可能性も考慮し、必要に応じて確認してください。

このガイドラインは継続的に見直し、改善していくものとします。
